### 1.2. 제품 요약

대학생들이 전공/교양과목의 PDF 학습 자료(강의안, 논문 등)를 업로드하면, Gemini 2.5 Pro AI가 PDF의 시각적/문맥적 정보를 종합 분석하여 핵심 개념의 계층 구조를 도출하고, 사용자의 지식 수준을 진단하여 맞춤형 해설과 연습문제를 제공하는 AI 기반 학습 서비스. 사용자의 취약점을 집중 공략하여 시험 준비 효율을 극대화하는 것을 목표로 한다.

### 1.3. 타겟 사용자

- **주요 타겟:** 대학교 시험을 준비하는 학부생
- **사용 환경:** 방대한 양의 PDF 강의안을 단기간에 효율적으로 학습하고, 자신의 취약점을 파악하여 보완하고 싶은 학생.

### 1.4. 해결하고자 하는 문제

- **정보 과부하:** 어떤 개념부터 공부해야 할지, 개념 간의 위계는 어떻게 되는지 파악하기 어렵다.
- **자기 진단의 어려움:** PDF를 읽는 것만으로는 무엇을 알고 무엇을 모르는지 객관적으로 진단하기 힘들다.
- **비효율적인 복습:** 틀린 문제나 모르는 개념과 관련된 부분을 원본 자료에서 다시 찾아보는 과정이 번거롭고 시간이 많이 소요된다.

---

### 2.0 제품 목표 (Goals)

### 2.1. 사용자 목표

- 자신이 학습할 PDF 내용의 전체적인 **지식 맵(Knowledge Map)**을 한눈에 파악한다.
- 자신의 **취약 개념을 명확히 인지**하고, 이를 중심으로 학습 계획을 세운다.
- 맞춤형 문제 풀이와 **원문 연동 오답 확인**을 통해 학습 성취도를 높이고 시험에 대한 자신감을 얻는다.

### 2.2. 제품 목표

- **학습 효율성 증대:** 사용자가 특정 PDF 자료를 학습 완료하는 데 걸리는 시간을 20% 이상 단축시킨다.
- **핵심 기능 활성화:** 최초 방문 사용자의 70% 이상이 [4단계] 맞춤형 문제 풀이 기능을 경험하게 한다.
- **학습 효과 입증:** 사용자의 지식 트리에서 '모름(빨간색)' 노드가 '앎(초록색)'으로 전환되는 비율을 측정하여 서비스의 학습 효과를 증명한다.

---

### 3.0 핵심 기능 명세 (Core Feature Specifications)

### **[F-01] 과목 관리 및 PDF 업로드**

- **설명:** 사용자는 과목별 폴더를 생성하고 학습할 PDF를 업로드한다.
- **UI/UX:**
    - 대시보드에서 과목 폴더 목록을 확인하고 '새 과목'을 생성할 수 있다.
    - 폴더 진입 후, 파일 드래그 앤 드롭 또는 '파일 선택' 버튼으로 PDF를 업로드한다.
- **백엔드/DB:**
    - `Supabase Storage`: PDF 원본 파일 저장.
    - `Supabase DB`: `subjects`, `documents` 테이블에 메타데이터 저장.
    - 대용량(>20MB) 파일을 위해 **Gemini File API** 연동을 고려한 아키텍처 설계.

### **[F-02] AI 지식 트리 생성 및 진단**

- **설명:** PDF 업로드 시, AI가 내용을 분석해 핵심 개념의 계층 구조(지식 트리)를 생성하고, 사용자는 각 개념에 대한 이해도를 체크한다.
- **UI/UX:**
    - 업로드 후 AI 분석이 진행 중임을 알리는 로딩 인디케이터와 안내 메시지 표시 (백그라운드 처리).
    - 분석 완료 후, 생성된 개념 리스트가 표시되며 각 항목마다 [🟢 앎], [🟠 애매함], [🔴 모름] 버튼으로 자가 진단을 수행한다.
- **AI 로직 (Prompt Engineering):**
    - **역할 부여:** "당신은 특정 학문 분야에 대한 깊은 이해를 바탕으로, 대학생을 위한 학습 커리큘럼을 설계하는 **전문 커리큘럼 설계자**입니다."
    - **핵심 지시:** "주어진 PDF의 텍스트, 도표, 구조를 종합 분석하여, 핵심 개념과 이를 이해하는 데 필요한 **선수 지식**까지 모두 도출하고, 이를 위계적인 계층 구조로 정리하세요."
    - **출력 형식 강제:** Gemini의 **구조화된 출력(Structured Output)** 기능을 사용. `response_mime_type: "application/json"`과 `response_schema`를 명시하여 정의된 `KnowledgeNode` 스키마에 맞는 안정적인 JSON 결과물을 받는다.
- **DB:** `knowledge_nodes`, `user_knowledge_status` 테이블에 결과 저장.

### **[F-03] 지식 트리 시각화 대시보드**

- **설명:** 사용자의 지식 상태를 인터랙티브한 트리 다이어그램으로 시각화하여 학습 현황을 직관적으로 보여준다.
- **UI/UX:**
    - `react-flow` 또는 `D3.js`를 활용하여 시각화.
    - 각 노드는 [🟢 앎], [🟠 애매함], [🔴 모름] 상태에 따라 색상이 동적으로 변경된다.

### **[F-04] 인터랙티브 PDF 뷰어 및 AI 해설지**

- **설명:** 좌측에는 원본 PDF 뷰어, 우측에는 AI가 생성한 해설지가 표시된다. 특히 문제 풀이 후 돌아오면 틀린 문제의 근거가 되는 부분이 PDF에 자동으로 하이라이트된다.
- **UI/UX:**
    - 2-Pane 레이아웃 구성.
    - **오답 하이라이팅:** [4단계]에서 틀린 문제의 근거 원문(`source_quote`)이 PDF 뷰어 내에 빨간색 형광펜 효과로 오버레이되어 표시된다.
    - 우측 해설지에서 특정 개념을 클릭하면 해당 개념에 대한 AI 생성 해설을 볼 수 있다.

### **[F-05] 개인화 AI 퀴즈 생성 및 풀이**

- **설명:** AI가 사용자의 취약점('모름'으로 체크한 개념)과 PDF 내용을 기반으로 맞춤형 퀴즈를 생성한다.
- **UI/UX:**
    - '퀴즈 풀기' 버튼으로 시작. 한 번에 한 문제씩 제시되며, 답안 제출 시 즉시 채점 결과와 해설을 보여준다.
- **AI 로직 (Prompt Engineering):**
    - **역할 부여:** "당신은 모든 문제의 근거를 명확히 제시하는 **꼼꼼한 대학교 시험 출제위원**입니다."
    - **핵심 지시:** "사용자가 모르는 개념 리스트를 중심으로, PDF 내용에 근거한 응용 문제를 생성하세요. 각 문제마다 근거가 되는 PDF의 **정확한 원문(source_quote)**을 반드시 함께 제공해야 합니다."
    - **출력 형식 강제:** **구조화된 출력**을 사용하여 `QuizItem` 스키마(question, options, answer, explanation, source_quote 포함)에 맞는 JSON 결과물을 받는다.
- **DB:** `missed_questions` 테이블에 틀린 문제 데이터(특히 `source_quote`)를 저장.

### **[F-06] 유기적 학습 피드백 루프**

- **설명:** 사용자의 학습 활동 결과를 시스템에 반영하여 지속적인 성장을 유도하는 핵심 메커니즘.
- **로직:**
    1. **퀴즈 정답 시:** 해당 문제와 관련된 개념 노드가 `user_knowledge_status` 테이블에서 '모름(🔴)' -> '앎(🟢)'으로 업데이트되고, [F-03] 지식 트리에 즉시 반영된다.
    2. **퀴즈 오답 시:** 해당 문제는 `missed_questions` 테이블에 저장된다. 해당 과목의 다른 PDF에서 퀴즈를 풀 때, 이 테이블의 데이터를 참고하여 틀렸던 유형의 문제가 다시 출제될 확률이 높아진다.

---

### 4. 기술 스택 및 아키텍처

- **Frontend:** Next.js (React)
- **Deployment:** Vercel (Vercel CLI)
- **Backend/DB:** Supabase (PostgreSQL, Storage, Auth, Edge Functions)
- **AI Model:** Google Gemini 2.5 Pro
- **PDF Analysis:** Gemini 2.5 Pro의 네이티브 문서 이해 기능 (File API, Structured Output)
- **Libraries:** `react-pdf` (뷰어), `react-flow` (트리 시각화)

---